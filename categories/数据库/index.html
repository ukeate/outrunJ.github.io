<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://runout.run/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">
  <meta property="og:site_name" content="outrun的笔记">
  <meta property="og:title" content="数据库">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">
<title>数据库 | outrun的笔记</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://runout.run/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">
<link rel="stylesheet" href="/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css" integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.de073bde8a6e6d0bd83cd24901f31edc4f18d2b60264b1a5c09063bb3745c1c7.js" integrity="sha256-3gc73opubQvYPNJJAfMe3E8Y0rYCZLGlwJBjuzdFwcc=" crossorigin="anonymous"></script>
<link rel="alternate" type="application/rss+xml" href="https://runout.run/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/index.xml" title="outrun的笔记" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  <script data-ad-client="ca-pub-6239994681364905" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<meta name="baidu_union_verify" content="aacbc30462cce84b2333063d99284e3b">
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" class="book-icon" /><span>outrun的笔记</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/" class="">架构</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/code/" class="">代码</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/code/security/" class="">Security</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/code/design_mode/" class="">Java设计模式</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/project/" class="">工程设计</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/project/ddd/" class="">工程</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/project/frontend/" class="">前端</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>战略性技术</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/strategy/ai/" class="">AI</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/strategy/ai/map/" class="">知识图谱</a>
  

        </li>
      
    
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/strategy/iot/" class="">IoT</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/strategy/iot/framework/" class="">Framework</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/strategy/meta/" class="">IoT</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/strategy/meta/media/" class="">媒体</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/strategy/middle_platform/" class="">中台</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/strategy/block_chain/" class="">Block Chain</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>Cloud</span>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/strategy/datalake/" class="">Datalake</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/strategy/datalake/ecology/" class="">Ecology</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/strategy/edge/" class="">Edge</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/manage/" class="">Manage</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/manage/organize/" class="">组织</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/manage/organize/people/" class="">人员</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/method/" class="">Method</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/method/product_plan/" class="">产品规划</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/method/code_plan/" class="">代码规划</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/method/ops_plan/" class="">运维规划</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/method/advice_plan/" class="">咨询规划</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/method/architect/" class="">服务治理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/method/project_plan/" class="">项目规划</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/method/test_plan/" class="">测试规划</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/architect/summary/" class="">这些年我做过的技术</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/db/" class="">数据库</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/db/mongodb/" class="">Mongodb</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/db/postgresql/" class="">Postgre SQL</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/db/elasticsearch/" class="">Elasticsearch</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/db/mysql/" class="">Mysql</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/db/oracle/" class="">Oracle</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/db/redis/" class="">Redis</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/" class="">中间件</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/distributed/" class="">支撑-分布式</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/distributed/spring_cloud/" class="">Spring Cloud</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/library_frontend/" class="">前端</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/library_frontend/bootstrap/" class="">Bootstrap</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/library_frontend/threejs/" class="">Threejs</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/library_frontend/angular/" class="">Angular</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/library_frontend/jquery/" class="">Jquery</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/library_frontend/react/" class="">React</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/library/" class="">小功能</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/library/hibernate/" class="">Hibernate</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>Container</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/container/nginx/" class="">Nginx</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/middleware/container/nodejs/" class="">Nodejs</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/" class="">程序语言</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/principle/" class="">程序语言原理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/haskell/" class="">Haskell</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/elixir/" class="">Elixir</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/go/" class="">Go</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/python/" class="">Python</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/clojure/" class="">Clojure</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/js/" class="">JS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/java/" class="">Java</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/java/java_reactive/" class="">Java响应式编程</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/java/javaweb/" class="">JavaWeb</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/java/juc/" class="">Java并发</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/java/jvm/" class="">JVM</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/java/collection/" class="">Collection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/java/spring/" class="">Spring</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/markup_language/" class="">Markup Language</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/markup_language/html/" class="">Html</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/pl/markup_language/css/" class="">Css</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/" class="">工具</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/ops/" class="">运维</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/ops/monitor/" class="">Monitor</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/ops/docker/" class="">Docker</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/ops/k8s/" class="">Kubernetes</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/product/enterprise_system/" class="">企业级系统</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/develop/" class="">Develop</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/develop/eclipse/" class="">Eclipse</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/develop/vim/" class="">VIM</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/develop/apple/" class="">Apple</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/develop/jetbrains/" class="">Jetbrains</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/linux/" class="">Linux</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/linux/linux_program/" class="">LinuxProgram</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/linux/scene/" class="">LinuxScene</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/linux/linux_tool/" class="">LinuxTool</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/product/framework/" class="">Framework</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/physics/" class="">实物工具</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/test/" class="">测试</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/tool/test/debug/" class="">程序调试</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/cache/" class="">Cache</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/cache/ops/" class="">Ops</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/cache/work_code/" class="">Work Code</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/cache/template/" class="">模板配置</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/cache/soft_arch/" class="">软考架构师</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/misc/" class="">杂项</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/basic/" class="">基本功</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/basic/speach/" class="">演说</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/basic/body/" class="">身体</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/basic/computer/" class="">Computer</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/basic/computer/principle/" class="">支撑-原理</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/basic/computer/performance/" class="">Performance</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/basic/algorithm/" class="">算法</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/basic/algorithm/thought/" class="">算法思想</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/basic/algorithm/data_structure/" class="">数据结构</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/basic/algorithm/math/" class="">数学</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>数据库</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  <nav>
  <ul>
  
    
    <li class="book-section-flat">
      <strong>Categories</strong>
      <ul>
      
        <li class="flex justify-between">
          <a href="/categories/linux%E5%9C%BA%E6%99%AF/">Linux场景</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%AE%89%E5%85%A8/">安全</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/">系统编程</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
          <span>6</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
          <span>2</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%90%8E%E7%AB%AF/">后端</a>
          <span>4</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%94%AF%E6%92%91/">支撑</a>
          <span>2</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>
          <span>6</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%A7%84%E5%88%92/">规划</a>
          <span>5</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AE%BE%E8%AE%A1/">设计</a>
          <span>8</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%9E%B6%E6%9E%84/">架构</a>
          <span>8</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%85%83%E5%AE%87%E5%AE%99Web3.0/">元宇宙Web3.0</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%AA%92%E4%BD%93/">媒体</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E4%B8%9A%E5%8A%A1/">业务</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%9D%82%E9%A1%B9/">杂项</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%8A%9F%E8%83%BD/">功能</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AF%AD%E8%A8%80/">语言</a>
          <span>13</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
          <span>3</span>
        </li>
      
      </ul>
    </li>
    
  
    
    <li class="book-section-flat">
      <strong>Tags</strong>
      <ul>
      
      </ul>
    </li>
    
  
  </ul>
</nav>


  </aside>
  
 
      </header>

      
      
  
  <article class="markdown book-post">
    <h2>
      <a href="/docs/db/mongodb/">Mongodb</a>
    </h2>
    
  <div class="flex align-center text-small book-post-date">
    <img src="/svg/calendar.svg" class="book-icon " alt="" />
    <span>Oct 11, 2018</span>
  </div>



  
  <div class="text-small">
    
      <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
  </div>
  

  


    <p><h1 id="特点">
  特点
  <a class="anchor" href="#%e7%89%b9%e7%82%b9">#</a>
</h1>
<pre><code>    数据结构json(bson)
    易写入，易修改
    c++编写
    分布式
    介于关系数据库 和 非关系数据库之间
    查询语句强
    支持索引
    bson格式
</code></pre>
<h1 id="注意">
  注意
  <a class="anchor" href="#%e6%b3%a8%e6%84%8f">#</a>
</h1>
<pre><code>    document不能大于4Mb
    可以非安全模式异步马上成功
    每个连接用队列存储命令
</code></pre>
<h1 id="数据结构定义">
  数据结构定义
  <a class="anchor" href="#%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e5%ae%9a%e4%b9%89">#</a>
</h1>
<pre><code>    collection                                        # 表
            document                                # 记录
                    field(key, value)                # 字段(field)与值(value)
    与关系型数据库的区别
            document中的field不要key俱全或一样
            find()命令查询
</code></pre>
<h1 id="bson的数据类型">
  bson的数据类型
  <a class="anchor" href="#bson%e7%9a%84%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b">#</a>
</h1>
<pre><code>    ＃bson 是json的扩展
     # 增加了数据类型
     # 把json数据转换成二进制码存到文件
    null
    boolean
    undefined
    数组                                # 如{gps: [20, 56]}
    32位和64位整数                # shell中不支持
                                    ## node.js python java等高级语言的驱动中支持
    64位浮点                        # shell使用的全是这种类型, 如{x:3.14}
    utf-8                                # 字符串类型
    ObjectID
    Date                                # 如{x:new Date()}
    正则                                # 如{x:/uspcat/i}
    javascript块代码                # 如{x:function(){}}
                                    ## 相当于存储过程
    内嵌文档                        # 如{x: {xx: &quot;a&quot;}}
    二进制                                # shell中不能使用
</code></pre>
<h1 id="objectid">
  ObjectId
  <a class="anchor" href="#objectid">#</a>
</h1>
<pre><code>    大小
            12字节
            显示为24个十六进制字符
            # 空间换时间的思想
    细节
            前4字节是unix时间戳
            后3字节集群machine hash
            后2字节pid
            后3字节inc自增计数器, 在前面都相等时全局自增
</code></pre>
<h1 id="命名">
  命名
  <a class="anchor" href="#%e5%91%bd%e5%90%8d">#</a>
</h1>
<pre><code>    数据库与集合名
            不能是空字符串
            特殊字符
                    ' (空格) , $ / \ \0
            应该全小写
            小于64字节
            数据库名不与保留库名相同，如
                    admin, local, config
    集合名
            db-text合法，但不能db.db-text得到，要db.getCollection(&quot;db-text&quot;).text得到
                    # db-text 会认为是减法
                    ## 数据库名可以是db-text
            可以a.b来命名来划分子集合
                    不能以system.开头命名
</code></pre>
<h1 id="api">
  api
  <a class="anchor" href="#api">#</a>
</h1>
<pre><code>collection
        增
                save
                        # 不存在时插入，存在时更新
                        # {$ref: 'user', $id: 1} 来保存引用
                insert
        删
                remove('id': 'bar')        # 删除一条数据
                                                                        #remove()删除所有数据
                drop()                                # 删除persons collection, 不释放文件空间
                dropIndexes()                        # 删除所有索引
        改
                update(finder, updater, options或upser, multi)
                        # $set
                        # {age: {$gt: 18}, $isolated : 1} $isolated事务隔离该字段到本语句执行结束, does not work with sharded clusters
                findAndModify
        查
                findOne()
                find(finder, filter)
                        # limit(3).skip(10).sort({name: -1, age: 1})
                        ## sort({$natural: 1}) 固定集合排序
                        # explain() 返回带统计信息的文档
                        ## 是否用到索引，耗时，需要扫描多少文件
                        # hint({}) 强制使用某索引查询
                        # null可以匹配null, 也可以匹配{$exists: false}        
                        # 正则可以匹配自身，也可以模式字符串
                count()                                # document的条数
                aggregate

db
        # 默认存在的数据库admin, config, local
        sources
                # 从节点中设置的源collection
        help()
        persons.help()
                # 显示某集合的帮助
        auth('username', 'pwd')
                # 切换用户
        addUser()
                # addUser('admin', 'asdf')
                # addUser('readonly', 'asdf', true)
        listCommands()
        shutdownServer()
        eval()
                # 执行
        stats()                                        
                # 当前数据库的状态
                ## 包括名称，collection数，索引数等
        createCollection()
                # {'user', {capped: true, size: 100, max: 10}} 
                ## 创建固定集合, 100字节, 文档数上限为10
                ## 固定集合插入快，不能删除，无_id, 有尾部游标
        getCollection(&quot;persons&quot;).text
                # 同db.persons        
        dropDatabase()
                # 删除当前数据库        
        repairDatabase()
                # 释放空间
        serverStatus()
                # 返回数据库的metrics 数据
        serverStatus().metrics.cursor
                # 返回指针信息
        ensureIndex({x: 1, y: -1}, {name: 'xy'})
                # 建立x的升序, y的降序联合索引
                # 只使用索引的前部, 即对x的查询可以用该索引
                # {&quot;gps&quot;: '2d'} {'gps': '2dsphere'}
                ## 支持gps写成 [0, 0] {x: 0, y: 0} {latitude: 0, longitude: 0} 格式
                # 可以索引内嵌文档
                # {unique: true} 来建立唯一索引
                # {dropDups: true} 将唯一索引中重复的文档都删掉
        dropIndexes
        system
                indexes
                        # 保留集合，索引
                namespaces
                        # 也包含索引信息
                js
                        insert({_id: 'fn', value: function() {}})
                                # 用db.eval('fn()') 执行
        runCommand()
                # {'dropIndexes': 'col', 'index': 'ind'}
                # 可以返回命名执行的状态信息
                {buildInfo: 1}
                {collStats: 'user'}
                {distinct: 'user', key: a, query: {b: 0}}
                {drop: 'user'}
                {dropDatabase: 1}
                {dropIndexes: 'user', index: 'ind'}
                {getLastError: 1}
                        # 上次更新的作用信息
                        {getLastError: 1, w: 3}
                                # 阻塞复制，有3个节点
                {isMaster: 1}
                {findAndModify: 'user', query: {a: 0}, sort: {a: 1}, update: {$set: {a: 1}}}
                {listCommands: 1}
                {listDatabases: 1}
                {ping: 1}
                {renameCollection: 'user', to: 'user1'}
                {repairDatabase: 1}
                        # 修复并压缩当前数据库
                {serverStatus: 1}
                        # globalLock: 全局写入锁占用了多少时间
                        # mem: 内存映射了多少数据
                        # indexCounters: B树磁盘检索(misses)和内存检索(hits)的次数
                        # backgroundFluhing: 后台做了多少次fsync及用的时间
                        # opcounters: 每种主要操作的次数
                        # asserts: 断言的次数
                {convertToCapped: 'user', size: 100}
                        # 转为固定集合
                {fsync: 1, lock: 1}
                        # 缓冲写入磁盘，并加写入锁。后可以直接复制磁盘数据来备份
                        # db.$cmd.sys.unlock.findOne() 解锁
                        # db.currentOp() 查看为空时已解锁
                {resync: 1}
                        # 从节点重新同步
                {collMod: 'users', usePowerOf2Sizes: true}
                        # 每次增大空间总是2的倍数，适用于常写的集合
rs
        isMaster
        slaveOk
dcl
        help                                        # 显示帮助
        show dbs                                # 显示所有数据库
        use mydb                                # 选择数据库(默认为test)
                                                ## 如果没有该数据库，则创建(插入第一条数据时实际创建)
        db                                        # 显示当前数据库名
        show collections                        # 查看当前数据库的collections
        db.eval()                                # 执行shell语法字符串

        用户管理命令
                use test                                # 选择需要添加用户的数据库
                db.addUser('name','pwd')                # 第三个参数代表是否只读 true代表是 ,  false代表否
                                                        ## db 代表本数据库，也就是test
                db.system.users.find()                        # 查看用户列表
                db.auth('name','pwd')                # 用户认证，反回１代表认证成功
                db.removeUser('name')
                show users                                # 查看所有用户

                        # 注
                                权限生效需要mongod　以　-auth参数启动
                                admin数据库中的user是超级管理员 , 其他数据库中的user只限于本数据库

ttl(time to live)
        # mongodb每1分钟检查一次数据删除
        db.log_events.ensureIndex({&quot;createdAt&quot;: 1}, {expireAfterSeconds: 3600 })
        db.log_events.insert({
                &quot;createdAt&quot;: new Date(),
                &quot;logEvent&quot;: 2,
                &quot;logMessage&quot;: &quot;Success!&quot;
        })
                # 插入的这条数据在1小时后删除
        db.log_events.ensureIndex({&quot;expireAt&quot;: 1}, {expireAfterSeconds: 0})        
        db.log_events.insert({
                &quot;expireAt&quot;: new Date('July 22, 2013 14:00:00'),
                &quot;logEvent&quot;: 2,
                &quot;logMessage&quot;: &quot;Success!&quot;
        })
                # 插入的这条数据在July 22, 2013 14:00:00删除
</code></pre>
<h2 id="aggregate">
  aggregate
  <a class="anchor" href="#aggregate">#</a>
</h2>
<pre><code>mapReduce(
        function() {emit(this.cust_id, this.amount);},
                # map
        function(key, values) {return Array.sum(values)},
                # reduce
        {
                query: {status: 'A'},
                        # query
                out: 'order_totals'
                        # output
        } 
)

distinct()

count()

group({
        key: {a: 1},
                # $keyf: function(x) {return x.category} 定义分组函数
        cond: {a: {$lt: 3}}.
        $reduce: function(cur, result) {result.count += cur.count},
        initial: {count: 0},
        finalize: function (prev) {}
})
        # 返回的文档 {retval: [], count: 0, keys: 0, ok: 0}
aggregate([
        {$redact: {$cond: {
                if: {$eq: ['$level', 5]},
                then: '$$PRUNE',
                else: '$$DESCEND'
        }}}
        {$match: {status: 'A'}},
        {$geoNear: {...}},
        {$project: {name: {$toUpper: '$_id'}, _id: 0}},
        {$unwind: '$sizes'},
        {$group: {_id: '$state', totalPop: {$sum: '$pop'}}},
        {$skip: 10},
        {$limit: 5},
        {$sort: {age: -1}},
        {$out: 'authors'}
])

例子
    o-&gt; 得到tags数组的长度
    db.users.aggregate([{
            $group: {
                    _id: '$username',
                    tags_count: {$first: {$size: '$tags'}}
            }
    }])
    db.users.aggregate([{
            $project: {
                    tags_count: {$size: '$tags'}
            }
    }])
</code></pre>
<h2 id="expressions">
  expressions
  <a class="anchor" href="#expressions">#</a>
</h2>
<pre><code>$and
$or
$not
$setEquals
$setIntersection
$setUnion
$setDefference
$setIsSubset
$anyElementTrue
$allElementsTrue
$cmp
$eq
$gt
$gte
$lt
$lte
$ne
$add
$subtract
$multiply
$divide
$mod
$concat
$substr
$toLower
$toUpper
$strcasecmp
$meta
$size
$map
$let
$literal
$dayOfYear
$dayOfMonth
$dayOfWeek
$year
$month
$week
$hour
$minute
$second
$millisecond
$dateToString
$cond
$ifNull
$sum
$avg
$first
$last
$max
$min
$push
$addToSet
$near
$within
$box
$center
</code></pre>
<h2 id="对象">
  对象
  <a class="anchor" href="#%e5%af%b9%e8%b1%a1">#</a>
</h2>
<pre><code>全局函数
        printjson
        connect('localhost:27017/mydb')
                # 连接另一个服务器
        runProgram
对象类型
        cursor
                hasNext()
                        # 立即返回前100个数据与4Mb数据的较小者。取数据时直接读缓存
                next()
                forEach
</code></pre>
<h2 id="复制">
  复制
  <a class="anchor" href="#%e5%a4%8d%e5%88%b6">#</a>
</h2>
<pre><code>复制
        mongod --master --oplogSize 100
        mongod --slave --source localhost:27017
                # --source指定主节点
                # --only 指定只复制特定的数据库
                # --slavedelay 主从复制时的延时
                # --fastsync 从节点是主节点快照时，加这个选项，同步速度快
                # --autoresync 重新同步
                # --oplogSize 主节点oplog的大小
        db.sources.insert({host: 'localhost:27017'})
                # 从节点设置主节点

副本集
        #  没有主节点，集群自己选举主节点
        # 数据太多从节点会自动停止同步
        mongod --dbpath '/var/local/mongo1' --port 27017 --replSet rs0
                # 三个实例replSet 名必叫 rs0
        use admin
        rs.initiate({
                _id: 'a',
                members: [{
                        _id: 1,
                        host: 'localhost1:27017'
                }, {
                        _id: 2,
                        host: 'localhost1:27018'
                }]
        })
                # 其中一台执行初始化
        rs.add('localhost:27019')
        rs.status()
        db.getMongo().setSlaveOk()
        rs.isMaster()
        rs.conf()
        db.getReplicationInfo()
        db.printReplicationInfo()
        db.printSlaveReplicationInfo()
        use local        
        db.addUser('name', 'pwd')
                # 复制认证时用
</code></pre>
<h2 id="分片">
  分片
  <a class="anchor" href="#%e5%88%86%e7%89%87">#</a>
</h2>
<pre><code>mongods --port 3000 --configdb localhost:27017
        # 多个地址用,隔开
        # 每个片都就是副本集
mongo localhost:3000/admin
db.runCommand({addshard: 'localhost:27017‘, allowLocal: true})
        # 在localhost上运行时, 要设allowLocal
        # 'a/localhost:27017' 让mongo知道这个片所在的副本集
db.runCommand({enablesharding: 'db1'})
db.runCommand({shardcollection: 'db1.user', key: {_id: 1}})
db.printShardingStatus()
db.runCommand({removeshard: 'localhost:27017'})
</code></pre>
<h1 id="shell">
  shell
  <a class="anchor" href="#shell">#</a>
</h1>
<pre><code>mongo 127.0.0.1:27017/admin
        # 启动sell , 默认数据库为test
mongod –port 10000 –fork –logpath= logpath=/data/mongodb/log/mongodb.log -- logappend -- dbpath=/data/mongodb/data/db –config ~/.mongodb.conf 
        # 启动服务 -auth开启身份验证
        # --rest 开启http管理，其端口号比mongo端口号大1000
        ## --nohttpinterface关闭http管理
        # --bindip localhost 设置只能有某ip访问
        # --noscripting 完全禁止服务端js执行
        # --repair 启动并修复
        # 不要发送SIGKILL信号关闭(kill -9), 应发送SIGINT或SIGTERM
        mongod --remove                                
                # 结束服务
        // mongodb.conf
                port = 5586
                fork = true
                logpath = mongodb.log
mongodump --host 127.0.0.1 --port 27017 --out ./dir/name
        # 备份数据库
mongodump -h IP --port 端口 -u 用户名 -p 密码 -d 数据库 -o 文件存在路径
mongorestore --host 127.0.0.1 --port 27017 --directoryperdb ./dir/name
        # mongorestore -h IP --port 端口 -u 用户名 -p 密码 -d 数据库 --drop 文件存在路径
        # --drop 是先删除现有的数据
mongoexport -d tank -c users -o /home/outrun/mongo
        # 导出整张表
        ## mongoexport -h IP --port 端口 -u 用户名 -p 密码 -d 数据库 -c 表名 -f 字段 -q 条件导出 --csv -o 文件名
        # mongoexport -d tank -c users --csv -f uid,name,sex -o tank/users.csv 
        ## 导出表的部分字段
        # mongoexport -d tank -c users -q '{uid:{$gt:1}}' -o tank/users.json
        ## 根据条件导出数据
mongoimport -d tank -c users --upsert tank/users.dat
        # mongoimport -h IP --port 端口 -u 用户名 -p 密码 -d 数据库 -c 表名 --upsert --drop 文件名 
        ## 还原整表导出的非csv文件,  --upsert 表示插入或更新现有数据
        # mongoimport -h IP --port 端口 -u 用户名 -p 密码 -d 数据库 -c 表名 --upsertFields 字段 --drop 文件名
        ## 还原部分字段导出的文件, --upsertFields跟upsert一样
        ## 如 mongoimport -d tank -c users  --upsertFields uid,name,sex  tank/users.dat
        # mongoimport -h IP --port 端口 -u 用户名 -p 密码 -d 数据库 -c 表名 --type 类型 --headerline --upsert --drop 文件名  
        ## 还原导出的csv文件
        ## mongoimport -d tank -c users --type csv --headerline --file tank/users.csv
mongofiles put foo.txt
        # 使用gridfs
        list
        get foo.txt
        search
                # 按文件名查找
        delete foo.txt
mongostat
        # 实时输出mongo状态
</code></pre>
<h1 id="java-client">
  java client
  <a class="anchor" href="#java-client">#</a>
</h1>
<pre><code>1.导入mongo-java-drver-2.9.3.jar
2.api
        Mongo m = new Mongo(&quot;localhost&quot;, 27017);
        DB db = m.getDB(&quot;mydb&quot;);
        boolean auth = db.authenticate(&quot;root&quot;, &quot;root&quot;.toCharArray());
        System.out.println(&quot;身份认证&quot; + auth);
        // 获得所有数据库名
        for (String s : m.getDatabaseNames()) {
                System.out.println(&quot;db : &quot; + s);
        }
        // 删除数据库
        m.dropDatabase(&quot;my_new_db&quot;);
        // 获得collection列表
        Set&lt;String&gt; colls = db.getCollectionNames();
        for (String s : colls) {
                System.out.println(&quot;collection : &quot; + s);
        }
        // 获得一个collection
        DBCollection coll = db.getCollection(&quot;testCollection&quot;);
        // 创建document(包括内嵌文档)
        DBObject doc = new BasicDBObject().append(&quot;appendField&quot;, &quot;appendField&quot;);
        doc.put(&quot;name&quot;, &quot;MongoDB&quot;);
        doc.put(&quot;type&quot;, &quot;database&quot;);
        doc.put(&quot;count&quot;, 1);
        DBObject info = new BasicDBObject();
        info.put(&quot;x&quot;, 203);
        info.put(&quot;y&quot;, 102);
        doc.put(&quot;info&quot;, info);
        // 插入文档
        coll.insert(doc);
        // 查询文档
        DBObject doc2 = coll.findOne();
        System.out.println(doc2);
        // 统计文档数
        long count = coll.getCount();
        System.out.println(count);
        // 用游标遍历
        DBCursor cursor = coll.find();
        while (cursor.hasNext()) {
                DBObject object = cursor.next();
                System.out.println(object);
        }
        // 查询
        DBObject query = new BasicDBObject();
        query.put(&quot;i&quot;, 71);
        cursor = coll.find(query);
        // 条件查询
        query = new BasicDBObject();
        query.put(&quot;i&quot;, new BasicDBObject(&quot;$gt&quot;, 50)); // i&gt;50
        cursor = coll.find(query);
        // 创建索引
        coll.createIndex(new BasicDBObject(&quot;i&quot;, 1)); // 1代表升序 , -1是降序
        // 查询索引
        List&lt;DBObject&gt; list = coll.getIndexInfo();
                for (DBObject index : list) {
                System.out.println(&quot;索引 : &quot; + index);
        }
类型
    // 自动生成的唯一ID
    ObjectId id = new ObjectId();
    System.out.println(id);
</code></pre>
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/docs/db/postgresql/">Postgre SQL</a>
    </h2>
    
  <div class="flex align-center text-small book-post-date">
    <img src="/svg/calendar.svg" class="book-icon " alt="" />
    <span>Oct 11, 2018</span>
  </div>



  
  <div class="text-small">
    
      <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
  </div>
  

  


    <p><h1 id="命令">
  命令
  <a class="anchor" href="#%e5%91%bd%e4%bb%a4">#</a>
</h1>
<pre><code>initdb                          # 初始化数据库
    --locale en_US.UTF-8 
    -D 'data'
postgres                        # 启动数据库
    -D 目录
    -p 6543
pg_ctl start                    # 控制数据库: start, stop等
    -D data 
    -l a.log 
postmaster
    -D /data
psql
    -d db1
    -h localhost 
    -p 5432
    -U 用户名
    -W                          # 强制要求验证密码
    -f 导入sql命令文件, 或者在末尾加 &lt; a.sql 来导入
    -L 导出日志文件

    o-&gt;
    psql -U outrun -f pg.sql db1                    # 导入数据
pg_dump                         # 导出数据库
    -f                          # 指定文件
    -U                          # 用户
    -E UTF8                     # 编码
    -h localhost
    -n public                   # 指定schema
    -a                          # 只导数据，没有schema
    -F t                        # 压缩成tar

    o-&gt;
    pg_dump -U outrun -f pg.sql db1                 # 导出数据, -t tb1 导出表
pg_restore
    o-&gt;
    pg_restore -U outrun -d db1 pg.tar              # 导入压缩的数据
createdb                        # 创建数据库并指定 owner
    -hlocalhost -Upostgres -O 用户名 数据库名                        
dropdb
    -U user dbname
</code></pre>
<h1 id="特色sql">
  特色sql
  <a class="anchor" href="#%e7%89%b9%e8%89%b2sql">#</a>
</h1>
<pre><code>元命令
    \?                          # postgre命令
    \h                          # sql命令
    \l                          # 列出数据库
    \q                          # 退出
    \c 数据库名                 # 切换数据库
    \d name                     # 查看序列、表、视图、索引
        \dS+                    # 详情
    \du                         # 查看角色
    \dt                         # 查看所有表
        \dtS+                   # 详情
    \ds                         # 查看序列
    \i a.sql                    # 执行sql文件
    \o a.log                    # 日志文件
    \password                   # 更换密码
    \x                          # 开启/关闭竖排显示

    [sql] \gdesc                # 快速显示结果列名和类型
数据类型
    serial                      # 4字节，自增序列
        bigserial               # 8字节
    text default ''::text
    bigint default 0            # 8字节
        smallint                # 2字节
        int, integer            # 4字节
        decimal                 # 变长, 声明精度，精确
        numeric                 # 同上
        float
        real                    # 4字节，变精度，不精确
        double precision        # 8字节，变精度，不精确

    boolean default false
    text[]                      # text数组
    date
    time
    timestamp with time zone
    interval
    
    bytea                       # 二进制

    money
    uuid
约束
    constraint user_id primary key (id)
    constraint user_m_id unique(m_id)
    constraint fk_b_id foreign key (b_id) references tbb(id)
        MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
dcl
    create database db1
        owner outrun
    create user 'outrun' with password 'asdf'
    create role 用户名 with password '密码' login
        # 创建用户。role关键词可以省略

    drop database db1
    drop table tablename;

    alter database abc RENAME TO cba;
    alter database 数据库名 owner to 用户名
        # 更改数据库 owner
    alter table tb 
        add primary key (id)
        add foreign key(b_id) references tb(id) on update cascade on delete cascade
        add column c1 text
        alter column id type int using id::integer
        rename c1 to c2
            drop constraint fk_b_id foreign key (b_id) references tbb(id)
        drop [column] name
        owner to outrun
            # 更改表 owner
    
    alter role 用户名 with login                     # 添加权限
        password 'asdf'                             # with password 'asdf', 修改密码
        VALID UNTIL 'JUL 7 14:00:00 2012 +8'        # 设置角色有效期
        login, superuser, createdb, createrole, replication, inherit

    grant all privileges on database 数据库名 to 用户名
        # 授权数据库权限
ddl 
    insert into tb(&quot;desc&quot;) values ('a'); 
模糊查询
    ~                       # 匹配正则，大小写相关
        除'a$' '^a'的正则都只适合pg_trgm的gin索引
    ~*                      # 匹配正则，大小写无关
    !~                      # 不匹配该正则
    !~*
    ~ '^a'
        like 'a%'
    ~ 'a$'
    ~ 'ab.c'
        like '%ab_c%'

o-&gt; 视图 
CREATE VIEW myview 
AS 
SELECT city, temp_lo, temp_hi, prcp, date, location 
FROM weather, cities 
WHERE city = name;

o-&gt; 建表
create table dwh_timestamp_meta
(
&quot;id&quot; serial NOT NULL,
&quot;id&quot; serial primary key,
&quot;c_id&quot; serial references cities(id),
&quot;mongo_document_name&quot; text default ''::text,
&quot;last_update_time&quot; bigint default 0,
&quot;execute_time&quot; timestamp with time zone,
constraint pk_id primary key(id)
)
with (
oids=false
);

o-&gt; 序列
create table a(
    id bigint primary key
);
create sequence a_id_seq
    start with 1
    increment by 1
    no minvalue
    no maxvalue
    cache 1;
alter table a alter column id set default nextval('a_id_seq')
</code></pre>
<h1 id="数据字典">
  数据字典
  <a class="anchor" href="#%e6%95%b0%e6%8d%ae%e5%ad%97%e5%85%b8">#</a>
</h1>
<pre><code>pg_roles                        # 角色信息
pg_database                     # 数据库信息
information_schema
    select column_name from information_schema.columns where table_schema='public' and table_name='ad';
        # 表的所有列名
pg_stat_user_tables
    select relname from pg_stat_user_tables;
        # 所有表名
pg_stat_activity                # 活动状态
    SELECT pg_terminate_backend(pg_stat_activity.pid) FROM pg_stat_activity WHERE datname='garbage' AND pid&lt;&gt;pg_backend_pid();
        # 查看数据库活动连接
</code></pre>
<h1 id="配置">
  配置
  <a class="anchor" href="#%e9%85%8d%e7%bd%ae">#</a>
</h1>
<pre><code>数据库目录
    /usr/lib/systemd/system/postgresql.service
jdbc
    driver : org.postgresql.Driver
    url : jdbc:postgresql://localhost:5432/postgres
    初始用户名 : postgres
    初始数据库 : postgres
</code></pre>
<h1 id="存储过程">
  存储过程
  <a class="anchor" href="#%e5%ad%98%e5%82%a8%e8%bf%87%e7%a8%8b">#</a>
</h1>
<pre><code>drop function change_type1();
create or replace function change_type1()
returns int as
$body$
DECLARE
    r mongo_keys_type%rowtype;
    begin
    for r in select * from mongo_keys_type where type='number'
    loop
        EXECUTE 'alter table &quot;' || r.&quot;mongo_collection_name&quot; || '&quot; alter &quot;' || r.&quot;key&quot; || '&quot; type decimal';
    END LOOP;
    return 0;
    end
$body$
language 'plpgsql';

select change_type1()
</code></pre>
<h1 id="案例">
  案例
  <a class="anchor" href="#%e6%a1%88%e4%be%8b">#</a>
</h1>
<pre><code>授权
    grant all privileges on database 'db1' to 'outrun'
    alter role 'outrun' createdb
    alter role 'outrun' superuser
创建用户
    create user 'outrun' with password 'asdf'
    create role 'outrun' createdb password 'asdf' login
修改密码
    alter user 'outrun' with password 'asdf'
</code></pre>
    </p>
  </article>
  

  
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  <nav>
  <ul>
  
    
    <li class="book-section-flat">
      <strong>Categories</strong>
      <ul>
      
        <li class="flex justify-between">
          <a href="/categories/linux%E5%9C%BA%E6%99%AF/">Linux场景</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%AE%89%E5%85%A8/">安全</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/">系统编程</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
          <span>6</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
          <span>2</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%90%8E%E7%AB%AF/">后端</a>
          <span>4</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%94%AF%E6%92%91/">支撑</a>
          <span>2</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>
          <span>6</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%A7%84%E5%88%92/">规划</a>
          <span>5</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AE%BE%E8%AE%A1/">设计</a>
          <span>8</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%9E%B6%E6%9E%84/">架构</a>
          <span>8</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%85%83%E5%AE%87%E5%AE%99Web3.0/">元宇宙Web3.0</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%AA%92%E4%BD%93/">媒体</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E4%B8%9A%E5%8A%A1/">业务</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%9D%82%E9%A1%B9/">杂项</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%8A%9F%E8%83%BD/">功能</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AF%AD%E8%A8%80/">语言</a>
          <span>13</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
          <span>3</span>
        </li>
      
      </ul>
    </li>
    
  
    
    <li class="book-section-flat">
      <strong>Tags</strong>
      <ul>
      
      </ul>
    </li>
    
  
  </ul>
</nav>

 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












