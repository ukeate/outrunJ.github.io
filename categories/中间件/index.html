<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://runout.run/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">
  <meta property="og:site_name" content="outrun的笔记">
  <meta property="og:title" content="中间件">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">
<title>中间件 | outrun的笔记</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.c58292d36b18b675680ab9baea2029204537b839ea72f258746ec0f32ce8d6c8.css" integrity="sha256-xYKS02sYtnVoCrm66iApIEU3uDnqcvJYdG7A8yzo1sg=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.dc9a8161e6c374f95d1e4ce6b94723a050d02b08398745f1301dbdde08c5b9f0.js" integrity="sha256-3JqBYebDdPldHkzmuUcjoFDQKwg5h0XxMB293gjFufA=" crossorigin="anonymous"></script>
<link rel="alternate" type="application/rss+xml" href="https://runout.run/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/index.xml" title="outrun的笔记" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  <script data-ad-client="ca-pub-6239994681364905" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<meta name="baidu_union_verify" content="aacbc30462cce84b2333063d99284e3b">
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.png" alt="Logo" /><span>outrun的笔记</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  <ul>
<li><a href="/"><strong>介绍</strong></a></li>
<li><a href="/docs/architect"><strong>架构</strong></a>
<ul>
<li><a href="/docs/architect/method"><strong><strong>规划与方法</strong></strong></a>
<ul>
<li><a href="/docs/architect/method/product_plan">产品规划</a></li>
<li><a href="/docs/architect/method/advice_plan">咨询规划</a></li>
<li><a href="/docs/architect/method/test_plan">测试规划</a></li>
<li><a href="/docs/architect/method/architect">服务治理</a></li>
<li><a href="/docs/architect/method/ops_plan">运维规划</a></li>
<li><a href="/docs/architect/method/project_plan">项目规划</a></li>
<li><a href="/docs/architect/method/code_plan">代码规划</a></li>
</ul>
</li>
<li><a href="/docs/architect/strategy"><strong><strong>战略技术方案</strong></strong></a>
<ul>
<li><a href="/docs/architect/strategy/middle_platform"><strong><strong>中台</strong></strong></a></li>
<li><a href="/docs/architect/strategy/datalake"><strong><strong>湖仓一体</strong></strong></a>
<ul>
<li><a href="/docs/architect/strategy/big_data/ecology">生态体系</a></li>
</ul>
</li>
<li><a href="/docs/architect/strategy/ai"><strong><strong>人工智能</strong></strong></a>
<ul>
<li><a href="/docs/architect/strategy/ai/deep">深度学习</a></li>
<li><a href="/docs/architect/strategy/ai/map">知识图谱</a></li>
</ul>
</li>
<li><a href="/docs/architect/strategy/iot"><strong><strong>物联网</strong></strong></a>
<ul>
<li><a href="/docs/architect/strategy/iot/framework">框架</a></li>
</ul>
</li>
<li><a href="/docs/architect/strategy/block_chain"><strong><strong>区块链</strong></strong></a></li>
<li><a href="/docs/architect/strategy/meta"><strong><strong>元宇宙Web3.0</strong></strong></a>
<ul>
<li><a href="/docs/architect/strategy/meta/media">媒体</a></li>
</ul>
</li>
<li><a href="/docs/architect/strategy/cloud"><strong><strong>云原生</strong></strong></a></li>
<li><a href="/docs/architect/strategy/edge"><strong><strong>边缘计算</strong></strong></a></li>
</ul>
</li>
<li><a href="/docs/architect/project"><strong><strong>工程设计原则</strong></strong></a>
<ul>
<li><a href="/docs/architect/project/ddd">DDD</a></li>
<li><a href="/docs/architect/project/frontend">前端设计</a></li>
</ul>
</li>
<li><a href="/docs/architect/code"><strong><strong>代码原则</strong></strong></a>
<ul>
<li><a href="/docs/architect/code/design_mode">设计模式</a></li>
<li><a href="/docs/architect/code/security">安全/协议</a></li>
</ul>
</li>
<li><a href="/docs/architect/manage"><strong><strong>管理</strong></strong></a>
<ul>
<li><a href="/docs/architect/manage/organize"><strong><strong>组织</strong></strong></a>
<ul>
<li><a href="/docs/architect/manage/organize/people">人员</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/docs/architect/summary">这些年我做过的技术</a></li>
</ul>
</li>
<li><a href="/docs/tool"><strong>工具</strong></a>
<ul>
<li><a href="/docs/tool/linux"><strong><strong>Linux系统</strong></strong></a>
<ul>
<li><a href="/docs/tool/linux/linux_tool">Linux工具</a></li>
<li><a href="/docs/tool/linux/scene">Linux场景</a></li>
<li><a href="/docs/tool/linux/linux_program">Linux系统编程</a></li>
</ul>
</li>
<li><a href="/docs/tool/ops"><strong><strong>运维工具</strong></strong></a>
<ul>
<li><a href="/docs/tool/ops/monitor">监控指标</a></li>
<li><a href="/docs/tool/ops/docker">Docker</a></li>
<li><a href="/docs/tool/ops/k8s">Kubernetes</a></li>
</ul>
</li>
<li><a href="/docs/tool/develop"><strong><strong>开发工具</strong></strong></a>
<ul>
<li><a href="/docs/tool/develop/vim">Vim</a></li>
<li><a href="/docs/tool/develop/eclipse">Eclipse</a></li>
<li><a href="/docs/tool/develop/apple">Apple</a></li>
<li><a href="/docs/tool/develop/jetbrains">Jetbrains</a></li>
</ul>
</li>
<li><a href="/docs/tool/test"><strong><strong>测试工具</strong></strong></a>
<ul>
<li><a href="/docs/tool/test/debug">代码调试</a></li>
</ul>
</li>
<li><a href="/docs/tool/product"><strong><strong>产品工具</strong></strong></a>
<ul>
<li><a href="/docs/tool/product/enterprise_system">企业级系统</a></li>
<li><a href="/docs/tool/product/framework">服务与框架</a></li>
</ul>
</li>
<li><a href="/docs/tool/physics"><strong><strong>实物工具</strong></strong></a></li>
</ul>
</li>
<li><a href="/docs/middleware"><strong>中间件</strong></a>
<ul>
<li><a href="/docs/middleware/container"><strong><strong>容器</strong></strong></a>
<ul>
<li><a href="/docs/middleware/container/nginx">Nginx</a></li>
<li><a href="/docs/middleware/container/nodejs">Node.js</a></li>
</ul>
</li>
<li><a href="/docs/middleware/distributed"><strong><strong>分布式</strong></strong></a>
<ul>
<li><a href="/docs/middleware/distributed/spring_cloud">Spring Cloud</a></li>
</ul>
</li>
<li><a href="/docs/middleware/library"><strong><strong>库</strong></strong></a>
<ul>
<li><a href="/docs/middleware/library/hibernate">Hibernate</a></li>
</ul>
</li>
<li><a href="/docs/middleware/library_frontend"><strong><strong>前端库</strong></strong></a>
<ul>
<li><a href="/docs/middleware/library_frontend/jquery">JQuery</a></li>
<li><a href="/docs/middleware/library_frontend/bootstrap">Bootstrap</a></li>
<li><a href="/docs/middleware/library_frontend/angular">Angular</a></li>
<li><a href="/docs/middleware/library_frontend/react">React</a></li>
<li><a href="/docs/middleware/library_frontend/threejs">Three.js</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/docs/db"><strong>数据库</strong></a>
<ul>
<li><a href="/docs/db/mongodb">MongoDB</a></li>
<li><a href="/docs/db/mysql">Mysql</a></li>
<li><a href="/docs/db/oracle">Oracle</a></li>
<li><a href="/docs/db/postgresql">PgSQL</a></li>
<li><a href="/docs/db/redis">Redis</a></li>
<li><a href="/docs/db/elasticsearch">Elasticsearch</a></li>
</ul>
</li>
<li><a href="/docs/pl"><strong>语言</strong></a>
<ul>
<li><a href="/docs/pl/principle">原理</a></li>
<li><a href="/docs/pl/java"><strong><strong>Java</strong></strong></a>
<ul>
<li><a href="/docs/pl/java/jvm">JVM</a></li>
<li><a href="/docs/pl/java/collection">Java Collection</a></li>
<li><a href="/docs/pl/java/juc">Java Concurrent</a></li>
<li><a href="/docs/pl/java/spring">Spring</a></li>
<li><a href="/docs/pl/java/rxjava">RxJava</a></li>
<li><a href="/docs/pl/java/javaweb">JavaWeb</a></li>
</ul>
</li>
<li><a href="/docs/pl/go">GO</a></li>
<li><a href="/docs/pl/js">JS</a></li>
<li><a href="/docs/pl/python">Python</a></li>
<li><a href="/docs/pl/haskell">Haskell</a></li>
<li><a href="/docs/pl/clojure">Clojure</a></li>
<li><a href="/docs/pl/markup_language"><strong><strong>标记语言</strong></strong></a>
<ul>
<li><a href="/docs/pl/markup_language/html">HTML</a></li>
<li><a href="/docs/pl/markup_language/css">CSS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/docs/basic"><strong>基本功</strong></a>
<ul>
<li><a href="/docs/basic/algorithm"><strong><strong>算法</strong></strong></a>
<ul>
<li><a href="/docs/basic/algorithm/math">数学</a></li>
<li><a href="/docs/basic/algorithm/thought">思想</a></li>
<li><a href="/docs/basic/algorithm/data_structure">数据结构</a></li>
</ul>
</li>
<li><a href="/docs/basic/computer"><strong><strong>计算机</strong></strong></a>
<ul>
<li><a href="/docs/basic/computer/principle">原理</a></li>
<li><a href="/docs/basic/computer/performance">性能</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/docs/cache"><strong>Cache</strong></a>
<ul>
<li><a href="/docs/cache/ops">运维</a></li>
<li><a href="/docs/cache/template">模板配置</a></li>
<li><a href="/docs/cache/soft_arch">软考</a></li>
</ul>
</li>
<li><a href="/docs/misc"><strong>Misc</strong></a></li>
<li><a href="/posts"><strong>Posts</strong></a></li>
</ul>










</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>中间件</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  <nav>
  <ul>
  
    
    <li class="book-section-flat">
      <strong>Categories</strong>
      <ul>
      
        <li class="flex justify-between">
          <a href="/categories/linux%E5%9C%BA%E6%99%AF/">Linux场景</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%AE%89%E5%85%A8/">安全</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/">系统编程</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
          <span>6</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
          <span>2</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%90%8E%E7%AB%AF/">后端</a>
          <span>4</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%94%AF%E6%92%91/">支撑</a>
          <span>2</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>
          <span>6</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%A7%84%E5%88%92/">规划</a>
          <span>5</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AE%BE%E8%AE%A1/">设计</a>
          <span>8</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%9E%B6%E6%9E%84/">架构</a>
          <span>8</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%85%83%E5%AE%87%E5%AE%99Web3.0/">元宇宙Web3.0</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%AA%92%E4%BD%93/">媒体</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E4%B8%9A%E5%8A%A1/">业务</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%9D%82%E9%A1%B9/">杂项</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%8A%9F%E8%83%BD/">功能</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AF%AD%E8%A8%80/">语言</a>
          <span>13</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
          <span>3</span>
        </li>
      
      </ul>
    </li>
    
  
    
    <li class="book-section-flat">
      <strong>Tags</strong>
      <ul>
      
      </ul>
    </li>
    
  
  </ul>
</nav>


  </aside>
  
 
      </header>

      
      
  
  <article class="markdown book-post">
    <h2>
      <a href="/docs/middleware/">中间件</a>
    </h2>
    
  <h5>Oct 10, 2018</h5>



  
  <div>
    
      <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a>
  </div>
  

  




    <p><h1 id="容器服务">
  容器服务
  <a class="anchor" href="#%e5%ae%b9%e5%99%a8%e6%9c%8d%e5%8a%a1">#</a>
</h1>
<h2 id="tomcat">
  tomcat
  <a class="anchor" href="#tomcat">#</a>
</h2>
<pre><code>## 介绍
    tomcat从7开始默认就是nio的
## 配置
    bin/startup.bat
            set JAVA_HOME=
                            # 设置tomcat运行jdk
    context.xml
        &lt;Loader delegate=&quot;true&quot;/&gt;
                # true表示使用java加载器的代理模式
                ## false代表永远先在Web应用程序中寻找
    web.xml
        Content-Type: text/x-zim-wiki
        Wiki-Format: zim 0.4
        Creation-Date: 2013-08-04T19:40:08+08:00

        ====== web.xml文件 ======
        Created Sunday 04 August 2013

        &lt;servlet&gt;
                &lt;servlet-name&gt;
                &lt;servlet-class&gt;
                &lt;load-on-startup&gt;1
                &lt;init-param&gt;
                        &lt;param-name&gt;
                        &lt;param-value&gt;
        &lt;servlet-mapping&gt;
                &lt;servlet-name&gt;
                &lt;url-pattern&gt;

        &lt;welcome-file-list&gt;
                &lt;welcome-file&gt;

        &lt;filter&gt;
                &lt;filter-name&gt;
                &lt;filter-class&gt;
                &lt;init-param&gt;
        &lt;filter-mapping&gt;
                &lt;filter-name&gt;
                &lt;url-pattern&gt;

        &lt;mime-mapping&gt;
                &lt;extension&gt;bmp
                &lt;mime-type&gt;image/bmp

        &lt;error-page&gt;
                &lt;exception-type&gt;异常类的完全限定名 /&lt;error-code&gt;错误码
                &lt;location&gt;以“/”开头的错误处理页面路径

## 启动顺序
    web.xml中配置的启动顺序
            监听器
            过滤器
            servlet
                    load-on-startup属性值越小越先启动

    tomcat的加载过程：        # 分析启动日志得到
            启动http协议
            启动catalina
            启动servlet引擎
            加载xml配置文件
            初始化日志配置
            初始化ContextListener
            初始化SessionListener
            部署web项目
                    spring监听器，加载xml配置(开始spring自己的日志记录)
                            实例化bean
                                    初始化c3p0连接池的记录显示
                                    初始化LocalSessionFactoryBean的记录显示
                    application监听器(监听器按配置顺序启动)
                    struts过滤器，加载xml配置(开始struts自己的日志记录)
                            struts-default.xml
                                    根据其中配置的bean属性加载类，并记录了日志
                            struts-plugin.xml                # 里面有加载spring-struts-plugin包
                                    初始化struts-spring 集成
                            struts.xml
## 目录
    LICENSE
    NOTICE
    RELEASE-NOTES
    RUNNING.txt
    bin
            bootstrap.jar
            commons-daemon.jar
            tomcat-juli.jar
            tomcat-native.tar.gz
            commons-daemon-native.tar.gz
            catalina.bat
            shutdown.bat
            startup.bat
            cpappend.bat
            digest.bat
            setclasspath.bat
            tool-wrapper.bat
            version.bat
            catalina.sh
            shutdown.sh
            startup.sh
            digest.sh
            setclasspath.sh
            tool-wrapper.sh
            version.sh
            catalina-tasks.xml
    conf
            catalina.policy
            catalina.properties
            logging.properties
            context.xml
            server.xml
            tomcat-users.xml
            web.xml
            Catalina
                    localhost
                            host-manager.xml
                            manager.xml
    lib
            annotations-api.jar
            catalina.jar
            catalina-ant.jar
            catalina-ha.jar
            catalina-tribes.jar
            el-api.jar
            jasper.jar
            jasper-el.jar
            jasper-jdt.jar
            jsp-api.jar
            servlet-api.jar
            tomcat-coyote.jar
            tomcat-dbcp.jar
            tomcat-i18n-es.jar
            tomcat-i18n-fr.jar
            tomcat-i18n-ja.jar
    log
            catalina.2013-07-28.log等等
    webapps
            ROOT
                    WEB-INF
                            web.xml
            docs
            examples
            manager
            host-manager
    tmp
    work

    发布
            conf/server.xml 中8080端口 位置
            &lt;Context path=&quot;/bbs&quot; reloadable=&quot;true&quot; docBase=&quot;E:\workspace\bbs&quot; workDir=&quot;E:\workspace\bbs\work&quot; /&gt;

    发布war文件：
            localhost:8080 -&gt; tomcat manager -&gt; WAR file to deploy
</code></pre>
<h2 id="netty">
  netty
  <a class="anchor" href="#netty">#</a>
</h2>
<pre><code>介绍
    JBOSS提供，由Trustin Lee开发，比mina晚
    java开源框架
对比java nio
    java原生nio有bug(epoll bug)且编写困难, 网络可靠性自己处理
    netty设计优雅，使用方便，高性能、稳定
原理
    基于socket的数据流处理
        # socket数据流不是a queue of packets , 而是a queue of bytes, 所以分次传输的数据会成为a bunch of bytes
例子
    Handler
        ChannelHandler
            ChannelOutboundHandler
                    ChannelOutboundHandlerAdapter                        # 可作Encoder
                    MessageToByteEncoder
            ChannelInboundHandler                # 提供可重写的事件
                    ChannelInboundHandlerAdapter
                    ByteToMessageDecoder        # easy to deal with fragmentation issue
                            事件
                                    decode(ctx, in, out)                        # 内部处理过数据，堆积到了buffer(in)
                                                                            ## out中add了数据, 表示decode成功，则执行后抛弃in中数据
                                                                            # decode会被循环调用直到有一次out中没有add东西
                    ReplayingDecoder
                    事件
                            channelRead()                # 从client接收到数据时调用，数据的类型是ByteBuf
                                                    ## ByteBuf是 reference-counted object
                                                    ## 必须用ReferenceCountUtil.release(msg)或((ByteBuf) msg).release()来明确释放
                            exceptionCaught()        # 当抛出Throwable对象时调用
                            channelActive()                # as soon as a connection is established
            方法
                    handlerAdded()
                    handlerRemoved()
        ByteBuf
            方法
                    buf.writeBytes(m)                # 将m[ByteBuf]中的数据 cumulate into buf[ 定长的ByteBuf, 如ctx.alloc().buffer(4) ]
                    isReadable()                        # 返回ByteBuf中data的长度
        ChannelHandlerContext                # 用于触发一些i/o事件
            方法
                    write(msg)                # msg在flush后自动realease
                            write(msg, promise)                                # promise是ChannelPromise的对象，用来标记msg是否确切地写入到管道中
                    flush()
                    writeAndFlush(msg)                                        # 返回ChannelFuture
                    alloc()                                                        # 分配缓冲区来包含数据
        ByteBufAllocator
            buffer(4)                        # 返回存放32-bit Integer的ByteBuf
    Server
        EventLoopGroup
            NioEventLoopGroup                # 多线程 i/o eventloop
            方法
                    shutdownGracefully()                                                # 返回Funture类来通知group是否完全关闭并且所有group的channels都关闭
        ServerBootstrap                        # 建server的帮助类，链式编程
                                            ## 可以直接用Channel来建server
            方法
                group(bossGroup, workerGroup)                                # boss接收连接，worker处理boss中的连接
                        group(workerGroup)                                        # 只有一个参数时，该group即作boss也作worker
                channel(NioServerSocketChannel.class)                        # 用来接收连接的channel的类型
                        channel(NioSocketChannel.class)                        # create client-side channel
                childHandler(channelInitializer)                                # 新接收的channel总执行本handler
                                                                                ## 只有workerGroup时不用
                option(ChannelOption.SO_BACKLOG, 128)                        # channel实现的参数
                childOption(channelOption.SO_KEEPALIVE, true)                # option设置boss, childOption设置worker
                                                                                ## 在只有workerGroup时不用childOption,因为它没有parent
                bind(port)                                                        # 开始接收连接，返回的是ChannelFuture
                                                                                    ## 绑定网卡上的所有port端口，可以bind多次到不同的端口
        ChannelInitializer                        # 帮助设置channel, 如设置channel的pipeline中的handler
            实例
                new　ChannelInitializer&lt;SocketChannel&gt;(){
                        @Override
                        public void initChannel(SocketChannel ch) throws Exception{
                                ch.pipeline().addLast(new DiyHandler());
                        }
                }
        ChannelFuture
            方法
                sync()
                channel()                                                        # 返回Channel
                addListener(channelFutureListener)
        Channel
                closeFuture()                                                        # 返回ChannelFuture
        ChannelFutureListener
            实例
                new ChannelFutureListener(){
                    // 当请求结束时通知
                    @Override
                    public void operationComplete(ChannelFuture future){
                        assert f == future;
                        ctx.close();
                    }
                }
    client
        Bootstrap                        # for non-server channels such as a client-side or connectionless channel
            connect(host, port)
</code></pre>
<h2 id="netty-tcnative">
  netty-tcnative
  <a class="anchor" href="#netty-tcnative">#</a>
</h2>
<pre><code>介绍
        tomcat native 的分支
特点
        简化本地库的分配和连接
        可以maven配置dependency
        提供openssl的支持
</code></pre>
<h2 id="jetty">
  jetty
  <a class="anchor" href="#jetty">#</a>
</h2>
<pre><code># 是开源的servlet容器，基于java, 可以给jsp和servlet提供运行环境
# jetty容器可以实例化成一个对象，迅速为一些独立运行(stand-alone)的java应用提供网络和web连接
</code></pre>
<h2 id="apache">
  apache
  <a class="anchor" href="#apache">#</a>
</h2>
<pre><code># http容器，可容纳php, python。一请求一线程
安装
    pacman -S apache
    mkdir /srv/http
    chown http:http /srv/http
编译安装
    ./configure
        --prefix=/全路径/install_path
        --with-apxs2=/全路径/apxs            # 模块
    make
    make install
命令
    httpd
        -f                                  # 指定配置
        -t                                  # 配置检查
        -k
            start
            restart
            graceful
            stop
            graceful-stop
    apachectl
        graceful                            # 重载配置
        -f /全路径/httpd.conf                # 指定配置
        -t                                  # 配置检查
配置
    /etc/httpd/conf/httpd.conf
        DocumentRoot &quot;/srv/http&quot;            # 项目路径
        Listen                              # 端口
案例
    php
        docker解决
</code></pre>
<h2 id="lighttpd">
  lighttpd
  <a class="anchor" href="#lighttpd">#</a>
</h2>
<h2 id="meteor">
  meteor
  <a class="anchor" href="#meteor">#</a>
</h2>
<pre><code># 包装node
</code></pre>
<h2 id="ringojs">
  ringojs
  <a class="anchor" href="#ringojs">#</a>
</h2>
<pre><code># jvm上commonJs规范的服务器
</code></pre>
<h2 id="mina">
  mina
  <a class="anchor" href="#mina">#</a>
</h2>
<pre><code>apache提供， 由Trustin Lee开发，比netty更早
</code></pre>
<h2 id="tomcat-native">
  tomcat native
  <a class="anchor" href="#tomcat-native">#</a>
</h2>
<pre><code># 基于apr(apache portable runtime)技术，让tomcat在操作系统级别的交互上做的更好
</code></pre>
<h2 id="tinyhttpd">
  tinyHttpd
  <a class="anchor" href="#tinyhttpd">#</a>
</h2>
<h2 id="resin">
  resin
  <a class="anchor" href="#resin">#</a>
</h2>
<pre><code># 收费, 类似tomcat的java容器，性能提升
</code></pre>
<h2 id="uwsgi">
  uwsgi
  <a class="anchor" href="#uwsgi">#</a>
</h2>
<pre><code># 一个web服务器，实现了wsgi, uwsgi, http等协议
</code></pre>
<h2 id="weblogic">
  weblogic
  <a class="anchor" href="#weblogic">#</a>
</h2>
<pre><code># oracle
</code></pre>
<h2 id="was">
  was
  <a class="anchor" href="#was">#</a>
</h2>
<pre><code># ibm服务器
</code></pre>
<h2 id="gunicon">
  gunicon
  <a class="anchor" href="#gunicon">#</a>
</h2>
<pre><code># python wsgi http server
</code></pre>
<h2 id="nodejs">
  node.js
  <a class="anchor" href="#nodejs">#</a>
</h2>
<h2 id="openresty">
  OpenResty
  <a class="anchor" href="#openresty">#</a>
</h2>
<pre><code># 基于Nginx扩展
</code></pre>
<h2 id="tengine">
  Tengine
  <a class="anchor" href="#tengine">#</a>
</h2>
<pre><code># 基于Nginx扩展
</code></pre>
<h1 id="数据库访问">
  数据库访问
  <a class="anchor" href="#%e6%95%b0%e6%8d%ae%e5%ba%93%e8%ae%bf%e9%97%ae">#</a>
</h1>
<h2 id="druid">
  Druid
  <a class="anchor" href="#druid">#</a>
</h2>
<h2 id="sharding-jdbc">
  Sharding JDBC
  <a class="anchor" href="#sharding-jdbc">#</a>
</h2>
<h1 id="缓存">
  缓存
  <a class="anchor" href="#%e7%bc%93%e5%ad%98">#</a>
</h1>
<pre><code>缓存失效策略
	FIFO(First Input First Output)
	LRU(Least Recently Used)
	LFU(Least Frequently Used)
</code></pre>
<h2 id="客户端缓存">
  客户端缓存
  <a class="anchor" href="#%e5%ae%a2%e6%88%b7%e7%ab%af%e7%bc%93%e5%ad%98">#</a>
</h2>
<pre><code>Header
	Cache-Control: no-cache, no-store, max-age=0, must-revalidate
	Vary: Accept-Encoding
	Vary: Origin
	Vary: Access-Control-Request-Method
	Vary: Access-Control-Request-Headers
	Vary: Origin
	Vary: Access-Control-Request-Method
	Vary: Access-Control-Request-Headers
</code></pre>
<h2 id="本地缓存">
  本地缓存
  <a class="anchor" href="#%e6%9c%ac%e5%9c%b0%e7%bc%93%e5%ad%98">#</a>
</h2>
<pre><code>Ehcache
	堆内、堆外、磁盘三级缓存，可按容量制定缓存策略
	可按时间、次数制定过期策略
Guava Cache
	堆内缓存
Nginx本地缓存
Nginx PageSpeed插件
</code></pre>
<h2 id="缓存服务">
  缓存服务
  <a class="anchor" href="#%e7%bc%93%e5%ad%98%e6%9c%8d%e5%8a%a1">#</a>
</h2>
<pre><code>HTTP
	Nuster
		基于HAProxy的HTTP缓存服务器
	Varnish
		3台Varnish代替12台Squid
	Squid
Memcached
Redis
Tair
</code></pre>
<h1 id="配置服务发现">
  配置、服务发现
  <a class="anchor" href="#%e9%85%8d%e7%bd%ae%e6%9c%8d%e5%8a%a1%e5%8f%91%e7%8e%b0">#</a>
</h1>
<h2 id="apollo">
  Apollo
  <a class="anchor" href="#apollo">#</a>
</h2>
<pre><code># 支持推、拉模式更新
</code></pre>
<h2 id="eureka">
  Eureka
  <a class="anchor" href="#eureka">#</a>
</h2>
<h2 id="nacos">
  Nacos
  <a class="anchor" href="#nacos">#</a>
</h2>
<h1 id="rpc">
  RPC
  <a class="anchor" href="#rpc">#</a>
</h1>
<h2 id="dubbo">
  Dubbo
  <a class="anchor" href="#dubbo">#</a>
</h2>
<h2 id="thrift">
  Thrift
  <a class="anchor" href="#thrift">#</a>
</h2>
<h2 id="grpc">
  gRPC
  <a class="anchor" href="#grpc">#</a>
</h2>
<h1 id="消息队列">
  消息队列
  <a class="anchor" href="#%e6%b6%88%e6%81%af%e9%98%9f%e5%88%97">#</a>
</h1>
<pre><code>消息重发
    状态表记录消息状态
</code></pre>
<h2 id="pulsar">
  pulsar
  <a class="anchor" href="#pulsar">#</a>
</h2>
<pre><code># 雅虎开源, 存储和服务分离，高可用存储, 支持流
</code></pre>
<h2 id="rabbitmq">
  rabbitMQ
  <a class="anchor" href="#rabbitmq">#</a>
</h2>
<pre><code>介绍
    erlang开发, 重量级
    支持协议多，AMQP、XMPP、SMTP、STOMP
    Broker构架        # 消息在中心队列排队
install
        yum install rabbitmq-server
命令
        添加用户:
                rabbitmqctl add_user rainbird password
        添加权限:
                rabbitmqctl set_permissions -p &quot;/&quot; rainbird &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;
        删除测试用户:
                rabbitmqctl delete_user guest
原理
    虚拟主机 virtual host: 用户通过虚拟主机进行权限控制(如禁止A组访问B组的交换机)
            ＃ 默认虚拟主机为&quot;/&quot;
            队列 queue: 由生产者(producers)通过程序建立，再通过消费者(consuming)连接取走
                    消息:
                            路由键 routing key
            交换机 exchange: 负责把消息放入队列
                    绑定 binding(路由规则): 如指明交换机中具有路由键&quot;X&quot;的消息要到名为&quot;Y&quot;的队列中去
                            # 如果同一个键对应多个队列，则复制后分别发送

    功能
            持久化
                    队列和交换机创建时指定标志durable,指定队列和交换机重启生重建
                            ＃ 如果绑定了durable的队列和durable的交换机，该绑定自动保留
                            ＃ non-durable的交换机与durable的队列不能绑定
                            ＃ 一但创建durable标志，不能修改
                    消息发布到交换机时，指定标志Delivery Mode=2,这样消息会持久化
使用(原文http://adamlu.net/rabbitmq/tutorial-one-python)
        安装python 与插件支持
                pip
                python-pip git
                python-pika
        rabbitmq-server start
        send.py
            #!/usr/bin/env python
            import pika

            connection = pika.BlockingConnection(pika.ConnectionParameters(
                    host='localhost'))
            channel = connection.channel()

            channel.queue_declare(queue='hello')

            channel.basic_publish(exchange='',
                                routing_key='hello',
                                body='Hello World!')
            print &quot; [x] Sent 'Hello World!'&quot;
            connection.close()
                    receive.py
                            #!/usr/bin/env python
            import pika

            connection = pika.BlockingConnection(pika.ConnectionParameters(
                    host='localhost'))
            channel = connection.channel()

            channel.queue_declare(queue='hello')

            print ' [*] Waiting for messages. To exit press CTRL+C'

            def callback(ch, method, properties, body):
                print &quot; [x] Received %r&quot; % (body,)

            channel.basic_consume(callback,
                                queue='hello',
                                no_ack=True)

            channel.start_consuming()
</code></pre>
<h2 id="jafka">
  jafka
  <a class="anchor" href="#jafka">#</a>
</h2>
<pre><code>介绍
    基于kafka, 快速持久化(O(1)时间开销)
    高吞吐，一台普通服务器 100k/s
    完全分布式，Broker, Producer, Consumer原生支持分布式，自动负载均衡
    支持hadoop并行加载
</code></pre>
<h2 id="kafka">
  kafka
  <a class="anchor" href="#kafka">#</a>
</h2>
<pre><code>介绍
    apache子项目，scala语言编写, 发布订阅队列
    相对activeMQ轻量
特点
    push/pull队列架构，适合异构集群
    分布式, 高吞吐率, 易扩展
    支持数据并行到hadoop
    分区有序
    批量压缩, 零拷贝, 内存缓冲, 磁盘顺序写入
    可持久化
工具
    manager # 监控
</code></pre>
<h2 id="nsq">
  nsq
  <a class="anchor" href="#nsq">#</a>
</h2>
<pre><code>介绍
    go
工具
    admin   # 监控
</code></pre>
<h2 id="memcacheq">
  memcacheQ
  <a class="anchor" href="#memcacheq">#</a>
</h2>
<h2 id="zeromq">
  zeroMQ
  <a class="anchor" href="#zeromq">#</a>
</h2>
<h2 id="activemq">
  activeMQ
  <a class="anchor" href="#activemq">#</a>
</h2>
<pre><code>介绍
    apache子项目, 类似zeroMQ
通信方式
    点到点
        不成功时保存在服务端
    发布订阅
        不成功消息丢失
</code></pre>
<h2 id="beanstalkd">
  beanstalkd
  <a class="anchor" href="#beanstalkd">#</a>
</h2>
<h2 id="mqtt">
  mqtt
  <a class="anchor" href="#mqtt">#</a>
</h2>
<pre><code># 最早由ibm提供的，二进制消息的mq
</code></pre>
<h2 id="emqttd">
  emqttd
  <a class="anchor" href="#emqttd">#</a>
</h2>
<pre><code>介绍
    mqtt broker
</code></pre>
<h2 id="apollo-1">
  apollo
  <a class="anchor" href="#apollo-1">#</a>
</h2>
<pre><code>介绍
    apache mqtt broker
</code></pre>
<h2 id="metaq">
  metaq
  <a class="anchor" href="#metaq">#</a>
</h2>
<pre><code># 阿里mq
</code></pre>
<h1 id="定时任务">
  定时任务
  <a class="anchor" href="#%e5%ae%9a%e6%97%b6%e4%bb%bb%e5%8a%a1">#</a>
</h1>
<h2 id="cron">
  Cron
  <a class="anchor" href="#cron">#</a>
</h2>
<h2 id="xxl-job">
  XXL Job
  <a class="anchor" href="#xxl-job">#</a>
</h2>
<h2 id="quartz">
  quartz
  <a class="anchor" href="#quartz">#</a>
</h2>
<pre><code># java作业调度
配置applicationContext_job.xml
    job             # 任务内容
    jobDetail       # 调度方案
    trigger         # 时间
    scheduler       # jobDetail和trigger的容器
状态监控
    # 用日志表记录
    运行中
        JobListener监听器
    暂停中
        scheduler.pauseTrigger()
    等待中
        创建job时
</code></pre>
<h2 id="celery">
  celery
  <a class="anchor" href="#celery">#</a>
</h2>
<pre><code># python
</code></pre>
<h2 id="rundeck">
  rundeck
  <a class="anchor" href="#rundeck">#</a>
</h2>
<pre><code># java
</code></pre>
<h1 id="存储服务">
  存储服务
  <a class="anchor" href="#%e5%ad%98%e5%82%a8%e6%9c%8d%e5%8a%a1">#</a>
</h1>
<pre><code>存储的概念和术语
    scsi: 小型计算机系统接口(Small Computer System Interface)
    fc: 光纤通道(Fibre channel)
    das: 直连式存储(Direct-Attached Storage)
    nas: 网络接入存储(Network-Attached Storage)
    san: 存储区域网络(Storage Area Network)
        连接设备: 路由,  光纤交换机, 集线器(hub)
        接口: scsi fc
        通信协议: ip scsi
</code></pre>
<h2 id="iscsi">
  iscsi
  <a class="anchor" href="#iscsi">#</a>
</h2>
<pre><code># internet scsi
优点
    可以网络传输
    服务器数量无限
    在线扩容．动态部署
架构
    控制器架构: 专用数据传输芯片．专用RAID数据校验芯片．专用高性能cache缓存和专用嵌入式系统平台
    iscsi连接桥架构:
        前端协议转换设备(硬件)
        后端存储(scsi磁盘阵列．fc存储设备)
    pc架构
        存储设备搭建在pc服务器上，通过软件管理成iscsi, 通过网卡传输数据
        实现
            以太网卡 + initiator软件
            toe网卡 + initiator软件
            iscsi HBA卡
iscsi系统组成
    iscsi initiator 或　iscsi hba
    iscsi target
    以太网交换机
    一台或多台服务器
</code></pre>
<h2 id="fastdfs">
  fastdfs
  <a class="anchor" href="#fastdfs">#</a>
</h2>
<pre><code># 开源分布式文件系统
</code></pre>
<h2 id="cdn">
  cdn
  <a class="anchor" href="#cdn">#</a>
</h2>
<pre><code>介绍
    流量不大时带宽比cdn便宜, 流量大时cdn便宜。
    界限为250Mbps左右，价格在9k/month
价格     50TB/月        100TB/月
阿里云   3.8w/月        6.9w/月
盛大云   9k/月          1.7w/月
网宿
蓝汛
</code></pre>
<h2 id="aws-s3">
  AWS S3
  <a class="anchor" href="#aws-s3">#</a>
</h2>
<pre><code>命令
    aws
        s3
            cp --recursive bin s3://meiqia/crm-module/search/bin
                # 级联复制
            sync s3://meiqia/crm-module/search/bin bin
                # 下载
            rm --recursive s3://meiqia/crm-module/search
                # 级联删除
</code></pre>
<h1 id="网关">
  网关
  <a class="anchor" href="#%e7%bd%91%e5%85%b3">#</a>
</h1>
<h2 id="zuul">
  Zuul
  <a class="anchor" href="#zuul">#</a>
</h2>
<h2 id="spring-cloud-gateway">
  Spring Cloud Gateway
  <a class="anchor" href="#spring-cloud-gateway">#</a>
</h2>
<h2 id="kong">
  Kong
  <a class="anchor" href="#kong">#</a>
</h2>
<pre><code># 基于OpenResty
</code></pre>
<h1 id="日志">
  日志
  <a class="anchor" href="#%e6%97%a5%e5%bf%97">#</a>
</h1>
<h2 id="elk">
  ELK
  <a class="anchor" href="#elk">#</a>
</h2>
<pre><code># elasticsearch, logstash, kibana
FileBeat
    命令
    filebeat --environment systemd -c /etc/filebeat/filebeat.yml --path.home /usr/share/filebeat --path.config /etc/filebeat --path.data /var/lib/filebeat --path.logs /var/log/filebeat
</code></pre>
<h2 id="logio">
  log.io
  <a class="anchor" href="#logio">#</a>
</h2>
<h1 id="dns服务">
  DNS服务
  <a class="anchor" href="#dns%e6%9c%8d%e5%8a%a1">#</a>
</h1>
<h2 id="nscd">
  Nscd
  <a class="anchor" href="#nscd">#</a>
</h2>
<pre><code>DNS本地缓存
</code></pre>
<h1 id="实时计算">
  实时计算
  <a class="anchor" href="#%e5%ae%9e%e6%97%b6%e8%ae%a1%e7%ae%97">#</a>
</h1>
<pre><code>阿里云Flink
	集群
		计算单元
		vertex拓扑
	名词
		DataHub源表
		RDS维表
		RDS结果表
</code></pre>
    </p>
  </article>
  

  
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  <nav>
  <ul>
  
    
    <li class="book-section-flat">
      <strong>Categories</strong>
      <ul>
      
        <li class="flex justify-between">
          <a href="/categories/linux%E5%9C%BA%E6%99%AF/">Linux场景</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%AE%89%E5%85%A8/">安全</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/">系统编程</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
          <span>6</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
          <span>2</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%90%8E%E7%AB%AF/">后端</a>
          <span>4</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%94%AF%E6%92%91/">支撑</a>
          <span>2</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>
          <span>6</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%A7%84%E5%88%92/">规划</a>
          <span>5</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AE%BE%E8%AE%A1/">设计</a>
          <span>8</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%9E%B6%E6%9E%84/">架构</a>
          <span>8</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%85%83%E5%AE%87%E5%AE%99Web3.0/">元宇宙Web3.0</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%AA%92%E4%BD%93/">媒体</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E4%B8%9A%E5%8A%A1/">业务</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E6%9D%82%E9%A1%B9/">杂项</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E5%8A%9F%E8%83%BD/">功能</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AF%AD%E8%A8%80/">语言</a>
          <span>13</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
          <span>3</span>
        </li>
      
      </ul>
    </li>
    
  
    
    <li class="book-section-flat">
      <strong>Tags</strong>
      <ul>
      
      </ul>
    </li>
    
  
  </ul>
</nav>

 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












